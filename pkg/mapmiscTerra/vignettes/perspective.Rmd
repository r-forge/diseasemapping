<!--
%\VignetteEngine{knitr::docco_linear}
%\VignetteIndexEntry{Space Station Map Projections}
-->

# Space Station Map Projections

```{r setup}
library('mapmiscTerra', quietly=TRUE)
if(!exists('fact'))
  fact = 1
# uncomment for nicer images
# fact = 2 

```

```{r mapmiscCache, echo=FALSE, purl=FALSE}
  getOption('mapmiscCachePath')
  getOption('mapmiscCacheReadOnly')
```

```{r data}
data('worldMap');worldMap = unwrap(worldMap)

okinawa = geocode("Okinawa, Japan")
hk =  geocode("Hong Kong, China")
guam = geocode("Guam")
x = vect(cbind(130,15), crs=crsLL)
```




```{r projection}
myProj = tpers(x=vect(c(x,hk)), hKm = 2*1000, tilt =-15, axis='seu')
```








 
```{r mapLL}
map.new(attributes(myProj)$regionLL, buffer=2)
plot(attributes(myProj)$crop, add=TRUE, col='red')
plot(project(worldMap, crsLL), add=TRUE)
text(guam, 'guam')
text(hk, 'hk')
text(okinawa, 'Okinawa')
```









```{r doProj} 
  xProj = project(guam, myProj)
  yProj = project(hk, myProj)
  okinawaProj = project(okinawa, myProj)
```




```{r background}
myMap = openmap(myProj,  zoom=2,fact=2)
map.new(myProj, lwd=3)
plot(myMap, add=TRUE)
plot(wrapPoly(worldMap, myProj), add=TRUE)
```



```{r projOverDatelineNorth}
myProjDateLine = tpers(x=c(175,75), azi=40, hKm = 2*1000, tilt =-15, axis='seu')
myMapDateLine = openmap(myProjDateLine, zoom=2, fact=1)
plot(myMapDateLine, add=TRUE)
plot(wrapPoly(worldMap, myProjDateLine), add=TRUE)
```


```{r projOverDateline}
myProjDateLine = tpers(x=c(-165,0), azi=-70, hKm = 30*1000, tilt =-15, axis='seu')
myMapDateLine = openmap(myProjDateLine, zoom=2, fact=1, verbose=TRUE)
map.new(myProjDateLine)
plot(myMapDateLine, add=TRUE)
plot(wrapPoly(worldMap, myProjDateLine), add=TRUE)
```

```{r projOverDatelineSouth}
myProjDateLine = tpers(x=c(175,-85), azi=40, hKm = 20*1000, tilt =-15, axis='seu')
myMapDateLine = openmap(myProjDateLine, zoom=2)
map.new(myProjDateLine)
plot(myMapDateLine, add=TRUE)
plot(wrapPoly(worldMap, myProjDateLine), add=TRUE)
```


```{r backgroundOverDateline, include=FALSE, eval=FALSE, purl=FALSE}
  
  myMap1 = openmap(
      x=attributes(myProj)$regionLL[1,],
      crs=crsMerc, zoom=3,
      path='https://sat01.maps.yandex.net/tiles?l=sat&v=1.35.0&')
  
  
  myMap2 = openmap(
      x=attributes(myProj)$regionLL[2,],
      zoom=attributes(myMap1)$tiles$zoom,
      crs=crsMerc,
      path='https://sat01.maps.yandex.net/tiles?l=sat&v=1.35.0&')

plot(myMap2)

```



```{r map}
  map.new(myProj, bg='black', buffer=2*100*1000)
  plot(myMap, add=TRUE)
  plot(wrapPoly(worldMap, myProj), add=TRUE)  

  gridlinesWrap(myProj, col='yellow', 
      norths=seq(-40,40,by=10), easts=seq(-150,180,by=10),
      lty=2)
  
  points(xProj, col='red', pch=16, cex=2)
  text(xProj, 
      as.character(xProj$name),
      pos=2, col='red')
  
  points(okinawaProj, col='red', pch=16, cex=2)
  text(okinawaProj, 
      as.character(okinawaProj$name),
      pos=2, col='red')
  
  points(yProj, col='red', pch=16, cex=2)
  text(yProj, 
      as.character(yProj$name),
      pos=2, col='red')
 
}
```
