<!--
%\VignetteEngine{knitr::knitr}
%\VignetteIndexEntry{Fisher test}
-->

`https://github.com/clMathLibraries/clRNG`


## Fisher test simulation

```{r packages, results='hide'}
library('gpuR')
```

```{r memoryAvailable, echo=TRUE}
gpuInfo()$deviceName
gpuInfo()$maxAllocatableMem/(1024^3)
```


Create some streams
```{r test}

rowSums = vclVector(5,5,type="integer")
colSums = vclVector(4,6,type="integer")

Nglobal = c(4,2)
NperItem = 12

streams = clRNG:::cpp_mrg31k3pCreateStreams(prod(Nglobal))

z = vclVector(length=as.integer(prod(Nglobal)*NperItem), type="double")
length(z)


#clRNG::fisher_simGpu(x,y,z, streams, c(2L, 2L))
stuff = clRNG:::cpp_fisher_sim_gpu(rowSums, colSums, z, 
	#extraR, extraX, 
	streams, as.integer(Nglobal))


matrix(as.vector(z), ncol=prod(Nglobal), byrow=TRUE)


t(as.matrix(streams))

hist(as.vector(z))

```

