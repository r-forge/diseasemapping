<!--
%\VignetteEngine{knitr::knitr}
%\VignetteIndexEntry{INLA examples}
-->


# Weibull With Cure Fraction

the data
```{r }
data(Kidney, package='INLA')
head(Kidney)
```

scale the response variable
```{r scale}
Kidney$years = Kidney$time / 365.25
```




run the model 

```{r fitInla}
library("INLA")
mod = inla(
  inla.surv(years, event) ~ age * sex + 
    f(ID, model="iid", prior='pc.prec', param=c(0.5, 0.1)), 
  family="weibullcure", 
  control.family = list(hyper=list(
      'log alpha' = list(
        prior='loggamma', param=c(1,1)),
      'logit probability' = list(
        prior='logitbeta', param=c(1,1))
    )),
  data=Kidney, 
  control.inla=list(h=0.001), 
  control.mode = list(theta=c(0,-5,4), restart=TRUE),
  verbose=TRUE)
```

results

```{r results}
knitr::kable(mod$summary.fixed, digits=3)
knitr::kable(mod$summary.hyper, digits=3)
```

standard deviation
```{r sdSummary}
modSd = Pmisc::priorPost(mod)
knitr::kable(modSd$summary, digits=2)
```

```{r sdPlot}
modSd$matplot$xlim[1]=0
do.call(matplot, modSd$sd$matplot)
do.call(legend, modSd$legend)
```